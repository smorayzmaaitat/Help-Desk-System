import{g as x,A as y}from"./AuthenticatedLayout-PWHvvRgb.js";import{r as f,e as h,w,o as a,b as t,c as r,G as p,F as _,a as C,t as o,g,j as m,D as c,k as A,d as S}from"./app-Bshtgp-Q.js";import{_ as N}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ApplicationLogo-C-oCVjLM.js";const k={components:{BsChatLeftDotsFill:x,AuthenticatedLayout:y},props:{tickets:{type:Array,required:!0},comments:{type:Array,default:[]}},created(){console.log("Tickets data:",this.tickets)},data(){return{localComments:[...this.comments],ticket:this.tickets[0],selected_status:null,staff_note:null,staff_solutions:null,newComment:""}},created(){window.Echo.private("comments").listen("CommentAdded",n=>{var u;console.log("Event received:",n);const e=(u=this.tickets[0])==null?void 0:u.id;n.ticket_id===e&&this.localComments.push({id:n.id,ticket_id:n.ticket_id,user_id:n.user_id,user_name:n.user_name,user_role:n.user_role,content:n.content,created_at:n.created_at})})},methods:{supmit(n){const e={ticket_id:n.id,status:this.selected_status,staff_note:this.staff_note,staff_solutions:this.staff_solutions};this.$inertia.post("/tickets/staff_updateticket",e)},addComment(n){if(!this.newComment.trim()){alert("Comment cannot be empty.");return}const e={ticket_id:n.id,content:this.newComment};this.$inertia.post("/addcomments",e,{onSuccess:()=>{this.newComment=""}})},formatDateTime(n){if(!n)return"N/A";const e=new Date(n);return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")} ${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}`},ho(n){if(!n)return"N/A";const e=new Date(n);return` ${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}`}}},D={class:"bg-white rounded-lg shadow-md p-6 max-w-4xl mx-auto"},B={class:"space-y-4"},T={class:"flex justify-between items-center"},V={class:"font-bold"},F={class:"space-y-2"},L={key:0},U=["src"],E={key:1},M={class:"flex justify-between items-center mt-4"},R={class:"space-y-2"},j={class:"space-y-4 w-64"},I={class:"mt-2"},H={class:"mt-2"},P={class:"mt-2"},q=["onClick"],z={class:"relative flex items-center space-x-2 mb-1"},G={class:"ml-2 text-sm text-gray-500 bg-gray-100 px-2 rounded-full"},O={class:"max-h-60 overflow-y-auto border rounded-lg p-2 bg-gray-50 shadow-inner"},W={class:"text-gray-700"},Y={class:"text-gray-600"},J={class:"text-gray-800 mt-1"},K={class:"text-sm text-gray-500 mt-1"},Q={key:0,class:"text-gray-500 text-center py-4"},X={class:"mt-4 flex space-x-2"};function Z(n,e,u,$,l,d){const v=f("BsChatLeftDotsFill"),b=f("AuthenticatedLayout");return a(),h(b,null,{default:w(()=>[t("div",D,[e[11]||(e[11]=t("h1",{class:"text-2xl font-bold mb-4"},"Ticket Status",-1)),t("div",B,[(a(!0),r(_,null,p(u.tickets,s=>(a(),r("div",{key:s.id,class:"bg-gray-100 rounded-lg p-4"},[t("div",T,[t("div",null,[t("div",V,"ID: "+o(s.id||"N/A"),1),t("div",null,"Title: "+o(s.title||"N/A"),1),t("div",null,"Description: "+o(s.description||"N/A"),1)]),t("div",F,[t("div",null,"Category: "+o(s.category||"N/A"),1),t("div",null,"Priority: "+o(s.priority||"N/A"),1),t("div",null,"Department: "+o(s.department||"N/A"),1),t("div",null,[s.attachment?(a(),r("div",L,[s.attachment?(a(),r("img",{key:0,src:`/storage/${s.attachment}`,alt:"Attachment",class:"max-w-[150px] max-h-[150px] rounded"},null,8,U)):g("",!0)])):(a(),r("div",E,"Attachment: N/A"))])])]),t("div",M,[t("div",R,[t("div",null,"Created At: "+o(d.formatDateTime(s.created_at)),1),t("div",null,"Updated At: "+o(d.formatDateTime(s.updated_at)),1),t("div",null,"Checked By: "+o(s.checked_by||"N/A"),1),t("div",null,"Resolved By: "+o(s.resolved_by||"N/A"),1),t("div",null,"Resolved At: "+o(d.formatDateTime(s.resolved_at)),1),t("div",null,"Staff Note: "+o(s.staff_notes||"N/A"),1),t("div",null,"Staff Solutions: "+o(s.staff_solutions||"N/A"),1),t("div",null,"User Feedback: "+o(s.feedback||"N/A"),1)]),t("div",j,[t("div",null,"Status: "+o(s.status||"N/A"),1),t("div",null,"Time to Resolve: "+o(s.time_to_resolve||"N/A"),1),t("div",I,[e[6]||(e[6]=t("label",{class:"block text-sm font-medium text-gray-700"},"Status",-1)),m(t("select",{"onUpdate:modelValue":e[0]||(e[0]=i=>l.selected_status=i),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md"},e[5]||(e[5]=[t("option",{value:"open"},"Open",-1),t("option",{value:"in_progress"},"In Progress",-1),t("option",{value:"resolved"},"Resolved",-1),t("option",{value:"closed"},"Closed",-1)]),512),[[A,l.selected_status]])]),t("div",H,[e[7]||(e[7]=t("label",{class:"block text-sm font-medium text-gray-700"},"Staff Note",-1)),m(t("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=i=>l.staff_note=i),placeholder:"Enter staff note",class:"mt-1 block w-full px-3 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md"},null,512),[[c,l.staff_note]])]),t("div",P,[e[8]||(e[8]=t("label",{class:"block text-sm font-medium text-gray-700"},"Staff Solutions",-1)),m(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=i=>l.staff_solutions=i),placeholder:"Enter staff solutions",rows:"3",class:"mt-1 block w-full px-3 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md"},null,512),[[c,l.staff_solutions]])]),t("div",null,[t("button",{onClick:i=>d.supmit(s),class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-1 px-2 rounded mt-2 w-full"}," Submit ",8,q)])])])]))),128)),t("div",z,[e[9]||(e[9]=t("h2",{class:"text-lg font-semibold text-gray-800"},"Comments",-1)),C(v,{size:"18",class:"text-blue-500"}),t("span",G,o(l.localComments.length),1)]),t("div",O,[(a(!0),r(_,null,p(l.localComments,s=>(a(),r("div",{key:s.id,class:"border-b last:border-b-0 py-3 hover:bg-gray-100 transition-colors"},[t("p",null,[t("strong",W,o(s.user_name)+":",1),e[10]||(e[10]=S()),t("span",Y,o(s.user_role),1)]),t("p",J,o(s.content),1),t("p",K,o(d.ho(s.created_at)),1)]))),128)),l.localComments.length===0?(a(),r("div",Q,"No comments yet")):g("",!0)]),t("div",X,[m(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>l.newComment=s),type:"text",placeholder:"Write a comment...",class:"flex-grow border rounded px-3 py-2 focus:ring-2 focus:ring-blue-200 transition-all"},null,512),[[c,l.newComment]]),t("button",{onClick:e[4]||(e[4]=s=>d.addComment(l.ticket)),class:"bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded transition-colors"}," Send ")])])])]),_:1})}const nt=N(k,[["render",Z]]);export{nt as default};

import{g as x,A as b}from"./AuthenticatedLayout-PWHvvRgb.js";import{r as _,e as h,w as A,o as d,b as t,c as i,G as c,F as f,a as w,t as n,g as p,j as g,D as C,d as l,k as S}from"./app-Bshtgp-Q.js";import{_ as N}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ApplicationLogo-C-oCVjLM.js";const k={components:{BsChatLeftDotsFill:x,AuthenticatedLayout:b},props:{tickets:{type:Array,required:!0},staffList:{type:Array,required:!0,default:()=>[]},comments:{type:Array,default:[]}},data(){return{selected_staff:null,localComments:[...this.comments],ticket:this.tickets[0],newComment:""}},created(){window.Echo.private("comments").listen("CommentAdded",o=>{var u;console.log("Event received:",o);const e=(u=this.tickets[0])==null?void 0:u.id;console.log("-------------",o.ticket_id," ",e),o.ticket_id===e&&this.localComments.push({id:o.id,ticket_id:o.ticket_id,user_id:o.user_id,user_name:o.user_name,user_role:o.user_role,content:o.content,created_at:o.created_at})})},methods:{assignStaff(o){const e={ticket_id:o.id,staff_id:this.selected_staff};this.$inertia.post("/tickets/assign-staff",e)},addComment(o){if(!this.newComment.trim()){alert("Comment cannot be empty.");return}const e={ticket_id:o.id,content:this.newComment};this.$inertia.post("/addcomments",e,{onSuccess:()=>{this.newComment=""}})},formatDateTime(o){if(!o)return"N/A";const e=new Date(o);return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")} ${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}`},ho(o){if(!o)return"N/A";const e=new Date(o);return` ${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}`}}},D={class:"bg-white rounded-lg shadow-md p-6 max-w-4xl mx-auto"},B={class:"space-y-4"},L={class:"flex justify-between items-center"},T={class:"font-medium"},F={class:"font-medium"},V={class:"space-y-2"},M={class:"font-medium"},U={class:"font-medium"},j={class:"font-medium"},E={key:0},R=["src"],q={key:1},H={class:"flex justify-between items-center mt-4"},z={class:"text-sm bg-gray-50 p-3 rounded-md shadow-sm space-y-1"},G={class:"font-medium"},I={class:"font-medium"},P={class:"font-medium"},W={class:"font-medium"},Y={class:"font-medium"},J={class:"font-medium"},K={class:"font-medium"},O={class:"font-medium"},Q={class:"space-y-2"},X={class:"mt-2"},Z=["value"],$=["onClick"],tt={class:"mt-4"},et={class:"relative flex items-center space-x-2 mb-1"},st={class:"ml-2 text-sm text-gray-500 bg-gray-100 px-2 rounded-full"},ot={class:"max-h-60 overflow-y-auto border rounded-lg p-2 bg-gray-50 shadow-inner"},nt={class:"text-gray-700"},lt={class:"text-gray-600"},dt={class:"bg-gray-100"},it={class:"text-gray-800 mt-1"},at={class:"text-sm text-gray-500 mt-1"},rt={key:0,class:"text-gray-500 text-center py-4"},mt={class:"mt-4 flex space-x-2"};function ut(o,e,u,ct,a,r){const v=_("BsChatLeftDotsFill"),y=_("AuthenticatedLayout");return d(),h(y,null,{default:A(()=>[t("div",D,[e[19]||(e[19]=t("h1",{class:"text-2xl font-bold mb-4"},"Ticket Status",-1)),t("div",B,[(d(!0),i(f,null,c(u.tickets,s=>(d(),i("div",{key:s.id,class:"bg-gray-100 rounded-lg p-4"},[t("div",L,[t("div",null,[t("div",null,[e[3]||(e[3]=l("Title: ")),t("span",T,n(s.title||"N/A"),1)]),t("div",null,[e[4]||(e[4]=l("Description: ")),t("span",F,n(s.description||"N/A"),1)])]),t("div",V,[t("div",null,[e[5]||(e[5]=l("Category: ")),t("span",M,n(s.category||"N/A"),1)]),t("div",null,[e[6]||(e[6]=l("Priority: ")),t("span",U,n(s.priority||"N/A"),1)]),t("div",null,[e[7]||(e[7]=l("Department: ")),t("span",j,n(s.department||"N/A"),1)]),t("div",null,[s.attachment?(d(),i("div",E,[s.attachment?(d(),i("img",{key:0,src:`/storage/${s.attachment}`,alt:"Attachment",class:"max-w-[150px] max-h-[150px] rounded"},null,8,R)):p("",!0)])):(d(),i("div",q,"Attachment: N/A"))])])]),t("div",H,[t("div",z,[t("div",null,[e[8]||(e[8]=l("Created At: ")),t("span",G,n(r.formatDateTime(s.created_at)),1)]),t("div",null,[e[9]||(e[9]=l("Updated At: ")),t("span",I,n(r.formatDateTime(s.updated_at)),1)]),t("div",null,[e[10]||(e[10]=l("Checked By: ")),t("span",P,n(s.checked_by||"N/A"),1)]),t("div",null,[e[11]||(e[11]=l("Resolved By: ")),t("span",W,n(s.resolved_by||"N/A"),1)]),t("div",null,[e[12]||(e[12]=l("Resolved At: ")),t("span",Y,n(r.formatDateTime(s.resolved_at)),1)]),t("div",null,[e[13]||(e[13]=l("Staff Note: ")),t("span",J,n(s.staff_notes||"N/A"),1)]),t("div",null,[e[14]||(e[14]=l("Staff Solutions: ")),t("span",K,n(s.staff_solutions||"N/A"),1)]),t("div",null,[e[15]||(e[15]=l("User Feedback: ")),t("span",O,n(s.feedback||"N/A"),1)])]),t("div",Q,[t("div",null,"Status: "+n(s.status||"N/A"),1),t("div",null,"Time to Resolve: "+n(s.time_to_resolve||"N/A"),1),t("div",X,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-gray-700"},"Assign Staff",-1)),g(t("select",{"onUpdate:modelValue":e[0]||(e[0]=m=>a.selected_staff=m),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md"},[(d(!0),i(f,null,c(u.staffList,m=>(d(),i("option",{key:m.id,value:m.id},n(m.name),9,Z))),128))],512),[[S,a.selected_staff]])]),t("div",null,[t("button",{onClick:m=>r.assignStaff(s),class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-1 px-2 rounded mt-2 w-full"}," Submit ",8,$)])])])]))),128)),t("div",tt,[t("div",et,[e[17]||(e[17]=t("h2",{class:"text-lg font-semibold text-gray-800"},"Comments",-1)),w(v,{size:"18",class:"text-blue-500"}),t("span",st,n(a.localComments.length),1)]),t("div",ot,[(d(!0),i(f,null,c(a.localComments,s=>(d(),i("div",{key:s.id,class:"border-b last:border-b-0 py-3 hover:bg-gray-100 transition-colors"},[t("p",null,[t("strong",nt,n(s.user_name)+":",1),e[18]||(e[18]=l()),t("span",lt,n(s.user_role),1)]),t("div",dt,[t("p",it,n(s.content),1)]),t("p",at,n(r.ho(s.created_at)),1)]))),128)),a.localComments.length===0?(d(),i("div",rt,"No comments yet")):p("",!0)]),t("div",mt,[g(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>a.newComment=s),type:"text",placeholder:"Write a comment...",class:"flex-grow border rounded px-3 py-2 focus:ring-2 focus:ring-blue-200 transition-all"},null,512),[[C,a.newComment]]),t("button",{onClick:e[2]||(e[2]=s=>r.addComment(a.ticket)),class:"bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded transition-colors"}," Send ")])])])])]),_:1})}const vt=N(k,[["render",ut]]);export{vt as default};

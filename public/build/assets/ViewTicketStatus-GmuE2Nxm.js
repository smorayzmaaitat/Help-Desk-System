import{f as y,g as b,A as x}from"./AuthenticatedLayout-PWHvvRgb.js";import{r as m,e as A,w as C,o as a,b as t,c as l,G as _,F as p,a as w,t as n,g as c,j as f,D as h,d as k}from"./app-Bshtgp-Q.js";import{_ as N}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ApplicationLogo-C-oCVjLM.js";const S={components:{BsFillTicketPerforatedFill:y,BsChatLeftDotsFill:b,AuthenticatedLayout:x},props:{tickets:{type:Array,required:!0},comments:{type:Array,default:[]}},data(){return{localComments:[...this.comments],ticket:this.tickets[0],feedbackinput:null,newComment:""}},created(){window.Echo.private("comments").listen("CommentAdded",o=>{var i;console.log("Event received:",o);const s=(i=this.tickets[0])==null?void 0:i.id;o.ticket_id===s&&this.localComments.push({id:o.id,ticket_id:o.ticket_id,user_id:o.user_id,user_name:o.user_name,user_role:o.user_role,content:o.content,created_at:o.created_at})})},methods:{sendFeedback(o){const s={ticket_id:o.id,feedback:this.feedbackinput};this.$inertia.post("/tickets/feedback",s)},addComment(o){if(!this.newComment.trim()){alert("Comment cannot be empty.");return}const s={ticket_id:o.id,content:this.newComment};this.$inertia.post("/addcomments",s,{onSuccess:()=>{this.newComment=""}})},formatDateTime(o){if(!o)return"N/A";const s=new Date(o);return`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}-${String(s.getDate()).padStart(2,"0")} ${String(s.getHours()).padStart(2,"0")}:${String(s.getMinutes()).padStart(2,"0")}`},ho(o){if(!o)return"N/A";const s=new Date(o);return` ${String(s.getHours()).padStart(2,"0")}:${String(s.getMinutes()).padStart(2,"0")}`}}},D={class:"bg-white rounded-lg shadow-md p-6 max-w-4xl mx-auto"},F={class:"space-y-4"},B={class:"flex justify-between items-center"},T={class:"font-bold"},L={class:"space-y-2"},V={key:0},M=["src"],U={key:1},j={class:"flex justify-between items-center mt-4"},E={class:"space-y-2"},R={class:"space-y-2"},H={key:0},I=["onClick"],P={class:"relative flex items-center space-x-2 mb-1"},q={class:"ml-2 text-sm text-gray-500 bg-gray-100 px-2 rounded-full"},z={class:"max-h-60 overflow-y-auto border rounded-lg p-2 bg-gray-50 shadow-inner"},G={class:"text-gray-700"},W={class:"text-gray-600"},Y={class:"text-gray-800 mt-1"},$={class:"text-sm text-gray-500 mt-1"},J={key:0,class:"text-gray-500 text-center py-4"},K={class:"mt-4 flex space-x-2"};function O(o,s,i,Q,r,d){const g=m("BsChatLeftDotsFill"),v=m("AuthenticatedLayout");return a(),A(v,null,{default:C(()=>[t("div",D,[s[5]||(s[5]=t("h1",{class:"text-2xl font-bold mb-4"},"Ticket Status",-1)),t("div",F,[(a(!0),l(p,null,_(i.tickets,e=>(a(),l("div",{key:e.id,class:"bg-gray-100 rounded-lg p-4"},[t("div",B,[t("div",null,[t("div",T,"ID: "+n(e.id||"N/A"),1),t("div",null,"Title: "+n(e.title||"N/A"),1),t("div",null,"Description: "+n(e.description||"N/A"),1)]),t("div",L,[t("div",null,"Category: "+n(e.category||"N/A"),1),t("div",null,"Priority: "+n(e.priority||"N/A"),1),t("div",null,"Department: "+n(e.department||"N/A"),1),t("div",null,[e.attachment?(a(),l("div",V,[e.attachment?(a(),l("img",{key:0,src:`/storage/${e.attachment}`,alt:"Attachment",class:"max-w-[150px] max-h-[150px] rounded"},null,8,M)):c("",!0)])):(a(),l("div",U,"Attachment: N/A"))])])]),t("div",j,[t("div",E,[t("div",null,"Created At: "+n(d.formatDateTime(e.created_at)),1),t("div",null,"Updated At: "+n(d.formatDateTime(e.updated_at)),1),t("div",null,"Checked By: "+n(e.checked_by||"N/A"),1),t("div",null,"Resolved By: "+n(e.resolved_by||"N/A"),1),t("div",null,"Resolved At: "+n(d.formatDateTime(e.resolved_at)),1),t("div",null,"Staff Note: "+n(e.staff_notes||"N/A"),1),t("div",null,"Staff Solutions: "+n(e.staff_solutions||"N/A"),1),t("div",null,"User Feedback: "+n(e.feedback||"N/A"),1)]),t("div",R,[t("div",null,"Status: "+n(e.status||"N/A"),1),t("div",null,"Time to Resolve: "+n(e.time_to_resolve||"N/A"),1),e.feedback==null?(a(),l("div",H,[f(t("input",{"onUpdate:modelValue":s[0]||(s[0]=u=>r.feedbackinput=u),type:"text",class:"border rounded px-2 py-1 w-full"},null,512),[[h,r.feedbackinput]]),t("button",{onClick:u=>d.sendFeedback(e),class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-1 px-2 rounded mt-2 w-full"}," Send Feedback ",8,I)])):c("",!0)])])]))),128)),t("div",P,[s[3]||(s[3]=t("h2",{class:"text-lg font-semibold text-gray-800"},"Comments",-1)),w(g,{size:"18",class:"text-blue-500"}),t("span",q,n(r.localComments.length),1)]),t("div",z,[(a(!0),l(p,null,_(r.localComments,e=>(a(),l("div",{key:e.id,class:"border-b last:border-b-0 py-3 hover:bg-gray-100 transition-colors"},[t("p",null,[t("strong",G,n(e.user_name)+":",1),s[4]||(s[4]=k()),t("span",W,n(e.user_role),1)]),t("p",Y,n(e.content),1),t("p",$,n(d.ho(e.created_at)),1)]))),128)),r.localComments.length===0?(a(),l("div",J,"No comments yet")):c("",!0)]),t("div",K,[f(t("input",{"onUpdate:modelValue":s[1]||(s[1]=e=>r.newComment=e),type:"text",placeholder:"Write a comment...",class:"flex-grow border rounded px-3 py-2 focus:ring-2 focus:ring-blue-200 transition-all"},null,512),[[h,r.newComment]]),t("button",{onClick:s[2]||(s[2]=e=>d.addComment(r.ticket)),class:"bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded transition-colors"}," Send ")])])])]),_:1})}const st=N(S,[["render",O]]);export{st as default};

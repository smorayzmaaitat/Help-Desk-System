import{g as y,A as v}from"./AuthenticatedLayout-PWHvvRgb.js";import{r as u,e as h,w as x,o as d,b as e,c as a,G as c,F as f,a as b,t as o,g as p,j as A,D as C,d as i}from"./app-Bshtgp-Q.js";import{_ as w}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ApplicationLogo-C-oCVjLM.js";const S={components:{BsChatLeftDotsFill:y,AuthenticatedLayout:v},props:{tickets:{type:Array,required:!0},staffList:{type:Array,required:!0,default:()=>[]},comments:{type:Array,default:[]}},data(){return{selected_staff:null,localComments:[...this.comments],ticket:this.tickets[0],newComment:""}},created(){window.Echo.private("comments").listen("CommentAdded",n=>{var m;console.log("Event received:",n);const t=(m=this.tickets[0])==null?void 0:m.id;console.log("-------------",n.ticket_id," ",t),n.ticket_id===t&&this.localComments.push({id:n.id,ticket_id:n.ticket_id,user_id:n.user_id,user_name:n.user_name,user_role:n.user_role,content:n.content,created_at:n.created_at})})},methods:{assignStaff(n){const t={ticket_id:n.id,staff_id:this.selected_staff};this.$inertia.post("/tickets/assign-staff",t)},addComment(n){if(!this.newComment.trim()){alert("Comment cannot be empty.");return}const t={ticket_id:n.id,content:this.newComment};this.$inertia.post("/addcomments",t,{onSuccess:()=>{this.newComment=""}})},formatDateTime(n){if(!n)return"N/A";const t=new Date(n);return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")} ${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}`},ho(n){if(!n)return"N/A";const t=new Date(n);return` ${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}`}}},N={class:"bg-white rounded-lg shadow-md p-6 max-w-4xl mx-auto"},D={class:"space-y-4"},k={class:"flex justify-between items-center"},B={class:"font-medium"},L={class:"font-medium"},F={class:"space-y-2"},T={class:"font-medium"},V={class:"font-medium"},M={class:"font-medium"},j={key:0},E=["src"],U={key:1},$={class:"flex justify-between items-center mt-4"},q={class:"text-sm bg-gray-50 p-3 rounded-md shadow-sm space-y-1"},H={class:"font-medium"},R={class:"font-medium"},z={class:"font-medium"},G={class:"font-medium"},I={class:"font-medium"},P={class:"font-medium"},W={class:"font-medium"},Y={class:"font-medium"},J={class:"mt-4"},K={class:"relative flex items-center space-x-2 mb-1"},O={class:"ml-2 text-sm text-gray-500 bg-gray-100 px-2 rounded-full"},Q={class:"max-h-60 overflow-y-auto border rounded-lg p-2 bg-gray-50 shadow-inner"},X={class:"text-gray-700"},Z={class:"text-gray-600"},tt={class:"bg-gray-100"},et={class:"text-gray-800 mt-1"},st={class:"text-sm text-gray-500 mt-1"},nt={key:0,class:"text-gray-500 text-center py-4"},ot={class:"mt-4 flex space-x-2"};function it(n,t,m,dt,r,l){const _=u("BsChatLeftDotsFill"),g=u("AuthenticatedLayout");return d(),h(g,null,{default:x(()=>[e("div",N,[t[17]||(t[17]=e("h1",{class:"text-2xl font-bold mb-4"},"Ticket Status",-1)),e("div",D,[(d(!0),a(f,null,c(m.tickets,s=>(d(),a("div",{key:s.id,class:"bg-gray-100 rounded-lg p-4"},[e("div",k,[e("div",null,[e("div",null,[t[2]||(t[2]=i("Title: ")),e("span",B,o(s.title||"N/A"),1)]),e("div",null,[t[3]||(t[3]=i("Description: ")),e("span",L,o(s.description||"N/A"),1)])]),e("div",F,[e("div",null,[t[4]||(t[4]=i("Category: ")),e("span",T,o(s.category||"N/A"),1)]),e("div",null,[t[5]||(t[5]=i("Priority: ")),e("span",V,o(s.priority||"N/A"),1)]),e("div",null,[t[6]||(t[6]=i("Department: ")),e("span",M,o(s.department||"N/A"),1)]),e("div",null,[s.attachment?(d(),a("div",j,[s.attachment?(d(),a("img",{key:0,src:`/storage/${s.attachment}`,alt:"Attachment",class:"max-w-[150px] max-h-[150px] rounded"},null,8,E)):p("",!0)])):(d(),a("div",U,"Attachment: N/A"))])])]),e("div",$,[e("div",q,[e("div",null,[t[7]||(t[7]=i("Created At: ")),e("span",H,o(l.formatDateTime(s.created_at)),1)]),e("div",null,[t[8]||(t[8]=i("Updated At: ")),e("span",R,o(l.formatDateTime(s.updated_at)),1)]),e("div",null,[t[9]||(t[9]=i("Checked By: ")),e("span",z,o(s.checked_by||"N/A"),1)]),e("div",null,[t[10]||(t[10]=i("Resolved By: ")),e("span",G,o(s.resolved_by||"N/A"),1)]),e("div",null,[t[11]||(t[11]=i("Resolved At: ")),e("span",I,o(l.formatDateTime(s.resolved_at)),1)]),e("div",null,[t[12]||(t[12]=i("Staff Note: ")),e("span",P,o(s.staff_notes||"N/A"),1)]),e("div",null,[t[13]||(t[13]=i("Staff Solutions: ")),e("span",W,o(s.staff_solutions||"N/A"),1)]),e("div",null,[t[14]||(t[14]=i("User Feedback: ")),e("span",Y,o(s.feedback||"N/A"),1)])])])]))),128)),e("div",J,[e("div",K,[t[15]||(t[15]=e("h2",{class:"text-lg font-semibold text-gray-800"},"Comments",-1)),b(_,{size:"18",class:"text-blue-500"}),e("span",O,o(r.localComments.length),1)]),e("div",Q,[(d(!0),a(f,null,c(r.localComments,s=>(d(),a("div",{key:s.id,class:"border-b last:border-b-0 py-3 hover:bg-gray-100 transition-colors"},[e("p",null,[e("strong",X,o(s.user_name)+":",1),t[16]||(t[16]=i()),e("span",Z,o(s.user_role),1)]),e("div",tt,[e("p",et,o(s.content),1)]),e("p",st,o(l.ho(s.created_at)),1)]))),128)),r.localComments.length===0?(d(),a("div",nt,"No comments yet")):p("",!0)]),e("div",ot,[A(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>r.newComment=s),type:"text",placeholder:"Write a comment...",class:"flex-grow border rounded px-3 py-2 focus:ring-2 focus:ring-blue-200 transition-all"},null,512),[[C,r.newComment]]),e("button",{onClick:t[1]||(t[1]=s=>l.addComment(r.ticket)),class:"bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded transition-colors"}," Send ")])])])])]),_:1})}const ut=w(S,[["render",it]]);export{ut as default};
